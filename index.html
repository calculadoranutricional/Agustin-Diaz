<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>HTML + CSS + JS + TS + Noticias ğŸŒ</title>
  <meta name="description" content="Demo integrando HTML, CSS, JS, TS, clima, hora y noticias.">
  <meta name="keywords" content="HTML, CSS, JavaScript, TypeScript, noticias, clima, example">
  <meta name="author" content="Tu Nombre">

  <!-- âš ï¸ Asegurate de reemplazar YOUR_NEWSAPI_KEY por tu clave real -->
  <script src="https://cdn.jsdelivr.net/npm/typescript@5.9.2/lib/typescript.js"></script>

  <script>
    window.addEventListener("DOMContentLoaded", () => {
      const tsCode = document.querySelector("#ts")?.textContent ?? "";
      const jsCode = ts.transpile(tsCode, { target: "ESNext", module: "ESNext" });
      try {
        eval(jsCode);
      } catch (err) {
        console.error("Error ejecutando JS transpileado:", err);
      }
    });
  </script>

  <style>
    * { box-sizing: border-box; }
    body {
      font-family: system-ui, sans-serif;
      text-align: center;
      margin: 0;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      background: #f4f4f4;
    }
    main {
      padding: 1rem;
      flex: 1;
    }
    footer {
      padding: 0.7rem;
      background: #111;
      color: white;
    }
    .tarjeta {
      background: white;
      padding: 1rem;
      margin: 1rem auto;
      width: 90%;
      max-width: 500px;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
      text-align: left;
    }
    .meteo {
      font-size: 1.2rem;
      margin-top: 0.5rem;
    }
    .noticia {
      margin-bottom: 1rem;
    }
    .noticia h4 {
      margin: 0.5rem 0 0.3rem;
    }
    .noticia p {
      margin: 0.3rem 0;
    }
    .noticia a {
      color: #0645AD;
      text-decoration: none;
    }
    .noticia a:hover {
      text-decoration: underline;
    }
  </style>
</head>
<body>
  <header>
    <h1>Mi Demo Web ğŸŒ</h1>
    <p>Integrado: Clima | Hora | Usuario | Noticias</p>
  </header>

  <main id="contenido">
    <!-- Usuario -->
    <!-- Clima / Hora -->
    <section class="tarjeta" id="info-tiempo">
      <h3>ğŸ“… Fecha, ğŸ•’ Hora & ğŸŒ¤ï¸ Clima</h3>
      <p id="fecha-hora">Cargando...</p>
      <p id="clima" class="meteo">Obteniendo clima...</p>
    </section>

    <!-- Noticias aparecerÃ¡n acÃ¡ -->
    <section class="tarjeta" id="noticias">
      <h3>ğŸ“° Noticias recientes</h3>
      <div id="lista-noticias">Cargando noticias...</div>
    </section>
  </main>

  <footer>
    <p>Â© 2025 - Mi Web Integrada</p>
  </footer>

  <script id="ts" type="text/typescript">
    // â€”â€”â€”â€”â€”â€”â€”â€”â€” Usuario de ejemplo
    interface Usuario {
      nombre: string;
      edad: number;
      fechaNacimiento: string;
    }
    const usuarios: Usuario[] = [
      { nombre: "AgustÃ­n Diaz", edad: 28, fechaNacimiento: "14/01/1997" }
    ];
    usuarios.forEach(u => {
      document.querySelector("#contenido")?.insertAdjacentHTML(
        "afterbegin",
        `<p>ğŸ‘¤ Hola soy <strong>${u.nombre}</strong>, tengo ${u.edad} aÃ±os y nacÃ­ el ${u.fechaNacimiento}.</p>`
      );
    });

    // â€”â€”â€”â€”â€”â€”â€”â€”â€” Fecha y Hora en tiempo real
    function actualizarFechaHora() {
      const ahora = new Date();
      const fecha = ahora.toLocaleDateString("es-AR");
      const hora = ahora.toLocaleTimeString("es-AR");
      document.getElementById("fecha-hora")!.textContent =
        `ğŸ“… ${fecha} | ğŸ•’ ${hora}`;
    }
    actualizarFechaHora();
    setInterval(actualizarFechaHora, 1000);

    // â€”â€”â€”â€”â€”â€”â€”â€”â€” Clima (CÃ³rdoba Capital) con API pÃºblica
    async function obtenerClima() {
      const url =
        "https://api.open-meteo.com/v1/forecast?latitude=-31.42&longitude=-64.18&current_weather=true&timezone=America%2FArgentina%2FBuenos_Aires";
      try {
        const res = await fetch(url);
        const data = await res.json();
        const temp = data.current_weather.temperature;
        const code = data.current_weather.weathercode;
        const iconos: Record<number,string> = {
          0:"â˜€ï¸",1:"ğŸŒ¤ï¸",2:"â›…",3:"â˜ï¸",
          45:"ğŸŒ«ï¸",48:"ğŸŒ«ï¸",51:"ğŸŒ¦ï¸",61:"ğŸŒ§ï¸",
          71:"â„ï¸",95:"â›ˆï¸"
        };
        document.getElementById("clima")!.textContent =
          `${iconos[code] ?? "ğŸŒ"} ${temp}Â°C en CÃ³rdoba`;
      } catch (err) {
        console.error("Error obteniendo clima:", err);
        document.getElementById("clima")!.textContent =
          "âš ï¸ No se pudo obtener el clima";
      }
    }
    obtenerClima();
    setInterval(obtenerClima, 60000);

    // â€”â€”â€”â€”â€”â€”â€”â€”â€” Noticias con NewsAPI
    async function cargarNoticias() {
      const apiKey = "c9a01369403b4c618b31893010504c2f";  // â† REEMPLAZÃ con tu clave
      const url = `https://newsapi.org/v2/top-headlines?language=es&pageSize=5&apiKey=${apiKey}`;

      try {
        const res = await fetch(url);
        const data = await res.json();
        if (data.status === "ok") {
          const cont = document.getElementById("lista-noticias")!;
          cont.innerHTML = "";  // vaciar mensaje de carga
          data.articles.forEach((art: any) => {
            cont.insertAdjacentHTML("beforeend",
              `<div class="noticia">
                 <h4>${art.title}</h4>
                 <p>${art.description ?? ""}</p>
                 <a href="${art.url}" target="_blank" rel="noopener">Leer mÃ¡s</a>
               </div>`
            );
          });
        } else {
          console.error("NewsAPI error:", data);
          document.getElementById("lista-noticias")!.textContent =
            "âš ï¸ No se pudo cargar noticias";
        }
      } catch (err) {
        console.error("Error al cargar noticias:", err);
        document.getElementById("lista-noticias")!.textContent =
          "âš ï¸ Error al conectar con NewsAPI";
      }
    }
    cargarNoticias();
  </script>
</body>
</html>